# 1 通过threading.Lock/RLock 保证线程操作安全
```
# -*- coding: utf-8 -*-
import time
import threading


class Account:
    def __init__(self, account_no, balance):
        self.account_no = account_no
        self.balance = balance
        self.lock = threading.Lock()


def draw(account, draw_amount):
    account.lock.acquire()
    try:
        if account.balance >= draw_amount:
            time.sleep(0.001)  # 模拟发生了线程切换
            account.balance -= draw_amount
            print(threading.current_thread().name + "取钱成功！吐出钞票:" + str(draw_amount) + " 余额：" + str(account.balance))
        else:
            print(threading.current_thread().name + "取钱失败！余额不足！" + " 余额：" + str(account.balance))
    finally:
        account.lock.release()


acct = Account("账号", 1000)
t1 = threading.Thread(name='甲', target=draw, args=(acct, 800))
t2 = threading.Thread(name='乙', target=draw, args=(acct, 800))
t1.start()
t2.start()
```

# 2 supervisor
pip install supervisor, 安装成功后 echo_supervisord_conf 将看到示例配置信息
echo_supervisord_conf > /etc/supervisord.conf

Gunicorn的中文翻译是独角兽（读音：dú jiǎo mǔ），Gunicorn的英文翻译是"Green Unicorn"
pip install gunicorn==19.9.0
Requirement already satisfied: gunicorn==19.9.0 in /usr/lib/python2.7/site-packages (19.9.0)
pip install supervisor==4.2.5
Requirement already satisfied: supervisor==4.2.5 in /usr/lib/python2.7/site-packages (4.2.5)

gunicorn PmsService.wsgi:application



